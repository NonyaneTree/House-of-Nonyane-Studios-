<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Payslip Designer Payment</title>
<style>
body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; }
.container { max-width: 600px; margin: auto; background: #fff; padding: 20px; border-radius: 8px; text-align: center; }
button { padding: 10px 15px; font-size: 16px; background: #28a745; color: white; border: none; cursor: pointer; border-radius: 5px; }
button:hover { background: #218838; }
p { font-size: 16px; }
</style>
<script src="https://js.yoco.com/sdk/v1/yoco-sdk-web.js"></script>
</head>
<body>

<div class="container" id="paymentContainer">
    <h2>Unlock Payslip Designer</h2>
    <p>Pay <strong>100 ZAR</strong> to access unlimited payslip generation for 31 days.</p>
    <button id="payBtn">Pay Now</button>
    <p id="status"></p>
</div>

<script>
const payBtn = document.getElementById('payBtn');
const status = document.getElementById('status');

// Check if user already has access
const accessExpiry = localStorage.getItem('payslipAccessExpiry');
if(accessExpiry && new Date(accessExpiry) > new Date()){
    status.innerText = "You already have access! Reloading...";
    setTimeout(()=> window.location.href = "payslip.html", 2000);
}

// Initialize Yoco
const yoco = new YocoSDK({ publicKey: 'pk_live_88415492P4RYmO49b224' });

payBtn.addEventListener('click', () => {
    yoco.showPopup({
        amountInCents: 10000, // 100 ZAR = 10000 cents
        currency: 'ZAR',
        name: 'Payslip Designer Access',
        description: '31 days access',
        callback: function(response){
            if(response.error){
                status.innerText = 'Payment failed: ' + response.error.message;
            } else {
                status.innerText = 'Payment successful! Unlocking...';
                // Save access expiry for 31 days
                const expiryDate = new Date();
                expiryDate.setDate(expiryDate.getDate() + 31);
                localStorage.setItem('payslipAccessExpiry', expiryDate.toISOString());
                setTimeout(()=> window.location.href = "payslip.html", 1500);
            }
        }
    });
});
</script>

</body>
</html>
